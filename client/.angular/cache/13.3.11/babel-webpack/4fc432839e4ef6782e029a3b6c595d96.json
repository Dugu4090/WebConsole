{"ast":null,"code":"\"use strict\";\n\nvar __makeTemplateObject = this && this.__makeTemplateObject || function (cooked, raw) {\n  if (Object.defineProperty) {\n    Object.defineProperty(cooked, \"raw\", {\n      value: raw\n    });\n  } else {\n    cooked.raw = raw;\n  }\n\n  return cooked;\n};\n\nvar PacketKind = /*#__PURE__*/(() => {\n  (function (PacketKind) {\n    PacketKind[PacketKind[\"EOS\"] = 0] = \"EOS\";\n    PacketKind[PacketKind[\"Text\"] = 1] = \"Text\";\n    PacketKind[PacketKind[\"Incomplete\"] = 2] = \"Incomplete\";\n    PacketKind[PacketKind[\"ESC\"] = 3] = \"ESC\";\n    PacketKind[PacketKind[\"Unknown\"] = 4] = \"Unknown\";\n    PacketKind[PacketKind[\"SGR\"] = 5] = \"SGR\";\n    PacketKind[PacketKind[\"OSCURL\"] = 6] = \"OSCURL\";\n  })(PacketKind || (PacketKind = {}));\n\n  return PacketKind;\n})();\nexport class AnsiUp {\n  constructor() {\n    this.VERSION = \"6.0.6\";\n    this.setup_palettes();\n    this._use_classes = false;\n    this.bold = false;\n    this.faint = false;\n    this.italic = false;\n    this.underline = false;\n    this.fg = this.bg = null;\n    this._buffer = '';\n    this._url_allowlist = {\n      'http': 1,\n      'https': 1\n    };\n    this._escape_html = true;\n    this.boldStyle = 'font-weight:bold';\n    this.faintStyle = 'opacity:0.7';\n    this.italicStyle = 'font-style:italic';\n    this.underlineStyle = 'text-decoration:underline';\n  }\n\n  set use_classes(arg) {\n    this._use_classes = arg;\n  }\n\n  get use_classes() {\n    return this._use_classes;\n  }\n\n  set url_allowlist(arg) {\n    this._url_allowlist = arg;\n  }\n\n  get url_allowlist() {\n    return this._url_allowlist;\n  }\n\n  set escape_html(arg) {\n    this._escape_html = arg;\n  }\n\n  get escape_html() {\n    return this._escape_html;\n  }\n\n  set boldStyle(arg) {\n    this._boldStyle = arg;\n  }\n\n  get boldStyle() {\n    return this._boldStyle;\n  }\n\n  set faintStyle(arg) {\n    this._faintStyle = arg;\n  }\n\n  get faintStyle() {\n    return this._faintStyle;\n  }\n\n  set italicStyle(arg) {\n    this._italicStyle = arg;\n  }\n\n  get italicStyle() {\n    return this._italicStyle;\n  }\n\n  set underlineStyle(arg) {\n    this._underlineStyle = arg;\n  }\n\n  get underlineStyle() {\n    return this._underlineStyle;\n  }\n\n  setup_palettes() {\n    this.ansi_colors = [[{\n      rgb: [0, 0, 0],\n      class_name: \"ansi-black\"\n    }, {\n      rgb: [187, 0, 0],\n      class_name: \"ansi-red\"\n    }, {\n      rgb: [0, 187, 0],\n      class_name: \"ansi-green\"\n    }, {\n      rgb: [187, 187, 0],\n      class_name: \"ansi-yellow\"\n    }, {\n      rgb: [0, 0, 187],\n      class_name: \"ansi-blue\"\n    }, {\n      rgb: [187, 0, 187],\n      class_name: \"ansi-magenta\"\n    }, {\n      rgb: [0, 187, 187],\n      class_name: \"ansi-cyan\"\n    }, {\n      rgb: [255, 255, 255],\n      class_name: \"ansi-white\"\n    }], [{\n      rgb: [85, 85, 85],\n      class_name: \"ansi-bright-black\"\n    }, {\n      rgb: [255, 85, 85],\n      class_name: \"ansi-bright-red\"\n    }, {\n      rgb: [0, 255, 0],\n      class_name: \"ansi-bright-green\"\n    }, {\n      rgb: [255, 255, 85],\n      class_name: \"ansi-bright-yellow\"\n    }, {\n      rgb: [85, 85, 255],\n      class_name: \"ansi-bright-blue\"\n    }, {\n      rgb: [255, 85, 255],\n      class_name: \"ansi-bright-magenta\"\n    }, {\n      rgb: [85, 255, 255],\n      class_name: \"ansi-bright-cyan\"\n    }, {\n      rgb: [255, 255, 255],\n      class_name: \"ansi-bright-white\"\n    }]];\n    this.palette_256 = [];\n    this.ansi_colors.forEach(palette => {\n      palette.forEach(rec => {\n        this.palette_256.push(rec);\n      });\n    });\n    let levels = [0, 95, 135, 175, 215, 255];\n\n    for (let r = 0; r < 6; ++r) {\n      for (let g = 0; g < 6; ++g) {\n        for (let b = 0; b < 6; ++b) {\n          let col = {\n            rgb: [levels[r], levels[g], levels[b]],\n            class_name: 'truecolor'\n          };\n          this.palette_256.push(col);\n        }\n      }\n    }\n\n    let grey_level = 8;\n\n    for (let i = 0; i < 24; ++i, grey_level += 10) {\n      let gry = {\n        rgb: [grey_level, grey_level, grey_level],\n        class_name: 'truecolor'\n      };\n      this.palette_256.push(gry);\n    }\n  }\n\n  escape_txt_for_html(txt) {\n    if (!this._escape_html) return txt;\n    return txt.replace(/[&<>\"']/gm, str => {\n      if (str === \"&\") return \"&amp;\";\n      if (str === \"<\") return \"&lt;\";\n      if (str === \">\") return \"&gt;\";\n      if (str === \"\\\"\") return \"&quot;\";\n      if (str === \"'\") return \"&#x27;\";\n    });\n  }\n\n  append_buffer(txt) {\n    var str = this._buffer + txt;\n    this._buffer = str;\n  }\n\n  get_next_packet() {\n    var pkt = {\n      kind: PacketKind.EOS,\n      text: '',\n      url: ''\n    };\n    var len = this._buffer.length;\n    if (len == 0) return pkt;\n\n    var pos = this._buffer.indexOf(\"\\x1B\");\n\n    if (pos == -1) {\n      pkt.kind = PacketKind.Text;\n      pkt.text = this._buffer;\n      this._buffer = '';\n      return pkt;\n    }\n\n    if (pos > 0) {\n      pkt.kind = PacketKind.Text;\n      pkt.text = this._buffer.slice(0, pos);\n      this._buffer = this._buffer.slice(pos);\n      return pkt;\n    }\n\n    if (pos == 0) {\n      if (len < 3) {\n        pkt.kind = PacketKind.Incomplete;\n        return pkt;\n      }\n\n      var next_char = this._buffer.charAt(1);\n\n      if (next_char != '[' && next_char != ']' && next_char != '(') {\n        pkt.kind = PacketKind.ESC;\n        pkt.text = this._buffer.slice(0, 1);\n        this._buffer = this._buffer.slice(1);\n        return pkt;\n      }\n\n      if (next_char == '[') {\n        if (!this._csi_regex) {\n          this._csi_regex = rgx(templateObject_1 || (templateObject_1 = __makeTemplateObject([\"\\n                        ^                           # beginning of line\\n                                                    #\\n                                                    # First attempt\\n                        (?:                         # legal sequence\\n                          \\u001B[                      # CSI\\n                          ([<-?]?)              # private-mode char\\n                          ([d;]*)                    # any digits or semicolons\\n                          ([ -/]?               # an intermediate modifier\\n                          [@-~])                # the command\\n                        )\\n                        |                           # alternate (second attempt)\\n                        (?:                         # illegal sequence\\n                          \\u001B[                      # CSI\\n                          [ -~]*                # anything legal\\n                          ([\\0-\\u001F:])              # anything illegal\\n                        )\\n                    \"], [\"\\n                        ^                           # beginning of line\\n                                                    #\\n                                                    # First attempt\\n                        (?:                         # legal sequence\\n                          \\\\x1b\\\\[                      # CSI\\n                          ([\\\\x3c-\\\\x3f]?)              # private-mode char\\n                          ([\\\\d;]*)                    # any digits or semicolons\\n                          ([\\\\x20-\\\\x2f]?               # an intermediate modifier\\n                          [\\\\x40-\\\\x7e])                # the command\\n                        )\\n                        |                           # alternate (second attempt)\\n                        (?:                         # illegal sequence\\n                          \\\\x1b\\\\[                      # CSI\\n                          [\\\\x20-\\\\x7e]*                # anything legal\\n                          ([\\\\x00-\\\\x1f:])              # anything illegal\\n                        )\\n                    \"])));\n        }\n\n        let match = this._buffer.match(this._csi_regex);\n\n        if (match === null) {\n          pkt.kind = PacketKind.Incomplete;\n          return pkt;\n        }\n\n        if (match[4]) {\n          pkt.kind = PacketKind.ESC;\n          pkt.text = this._buffer.slice(0, 1);\n          this._buffer = this._buffer.slice(1);\n          return pkt;\n        }\n\n        if (match[1] != '' || match[3] != 'm') pkt.kind = PacketKind.Unknown;else pkt.kind = PacketKind.SGR;\n        pkt.text = match[2];\n        var rpos = match[0].length;\n        this._buffer = this._buffer.slice(rpos);\n        return pkt;\n      } else if (next_char == ']') {\n        if (len < 4) {\n          pkt.kind = PacketKind.Incomplete;\n          return pkt;\n        }\n\n        if (this._buffer.charAt(2) != '8' || this._buffer.charAt(3) != ';') {\n          pkt.kind = PacketKind.ESC;\n          pkt.text = this._buffer.slice(0, 1);\n          this._buffer = this._buffer.slice(1);\n          return pkt;\n        }\n\n        if (!this._osc_st) {\n          this._osc_st = rgxG(templateObject_2 || (templateObject_2 = __makeTemplateObject([\"\\n                        (?:                         # legal sequence\\n                          (\\u001B\\\\)                    # ESC                           |                           # alternate\\n                          (\\u0007)                      # BEL (what xterm did)\\n                        )\\n                        |                           # alternate (second attempt)\\n                        (                           # illegal sequence\\n                          [\\0-\\u0006]                 # anything illegal\\n                          |                           # alternate\\n                          [\\b-\\u001A]                 # anything illegal\\n                          |                           # alternate\\n                          [\\u001C-\\u001F]                 # anything illegal\\n                        )\\n                    \"], [\"\\n                        (?:                         # legal sequence\\n                          (\\\\x1b\\\\\\\\)                    # ESC \\\\\\n                          |                           # alternate\\n                          (\\\\x07)                      # BEL (what xterm did)\\n                        )\\n                        |                           # alternate (second attempt)\\n                        (                           # illegal sequence\\n                          [\\\\x00-\\\\x06]                 # anything illegal\\n                          |                           # alternate\\n                          [\\\\x08-\\\\x1a]                 # anything illegal\\n                          |                           # alternate\\n                          [\\\\x1c-\\\\x1f]                 # anything illegal\\n                        )\\n                    \"])));\n        }\n\n        this._osc_st.lastIndex = 0;\n        {\n          let match = this._osc_st.exec(this._buffer);\n\n          if (match === null) {\n            pkt.kind = PacketKind.Incomplete;\n            return pkt;\n          }\n\n          if (match[3]) {\n            pkt.kind = PacketKind.ESC;\n            pkt.text = this._buffer.slice(0, 1);\n            this._buffer = this._buffer.slice(1);\n            return pkt;\n          }\n        }\n        {\n          let match = this._osc_st.exec(this._buffer);\n\n          if (match === null) {\n            pkt.kind = PacketKind.Incomplete;\n            return pkt;\n          }\n\n          if (match[3]) {\n            pkt.kind = PacketKind.ESC;\n            pkt.text = this._buffer.slice(0, 1);\n            this._buffer = this._buffer.slice(1);\n            return pkt;\n          }\n        }\n\n        if (!this._osc_regex) {\n          this._osc_regex = rgx(templateObject_3 || (templateObject_3 = __makeTemplateObject([\"\\n                        ^                           # beginning of line\\n                                                    #\\n                        \\u001B]8;                    # OSC Hyperlink\\n                        [ -:<-~]*       # params (excluding ;)\\n                        ;                           # end of params\\n                        ([!-~]{0,512})        # URL capture\\n                        (?:                         # ST\\n                          (?:\\u001B\\\\)                  # ESC                           |                           # alternate\\n                          (?:\\u0007)                    # BEL (what xterm did)\\n                        )\\n                        ([ -~]+)              # TEXT capture\\n                        \\u001B]8;;                   # OSC Hyperlink End\\n                        (?:                         # ST\\n                          (?:\\u001B\\\\)                  # ESC                           |                           # alternate\\n                          (?:\\u0007)                    # BEL (what xterm did)\\n                        )\\n                    \"], [\"\\n                        ^                           # beginning of line\\n                                                    #\\n                        \\\\x1b\\\\]8;                    # OSC Hyperlink\\n                        [\\\\x20-\\\\x3a\\\\x3c-\\\\x7e]*       # params (excluding ;)\\n                        ;                           # end of params\\n                        ([\\\\x21-\\\\x7e]{0,512})        # URL capture\\n                        (?:                         # ST\\n                          (?:\\\\x1b\\\\\\\\)                  # ESC \\\\\\n                          |                           # alternate\\n                          (?:\\\\x07)                    # BEL (what xterm did)\\n                        )\\n                        ([\\\\x20-\\\\x7e]+)              # TEXT capture\\n                        \\\\x1b\\\\]8;;                   # OSC Hyperlink End\\n                        (?:                         # ST\\n                          (?:\\\\x1b\\\\\\\\)                  # ESC \\\\\\n                          |                           # alternate\\n                          (?:\\\\x07)                    # BEL (what xterm did)\\n                        )\\n                    \"])));\n        }\n\n        let match = this._buffer.match(this._osc_regex);\n\n        if (match === null) {\n          pkt.kind = PacketKind.ESC;\n          pkt.text = this._buffer.slice(0, 1);\n          this._buffer = this._buffer.slice(1);\n          return pkt;\n        }\n\n        pkt.kind = PacketKind.OSCURL;\n        pkt.url = match[1];\n        pkt.text = match[2];\n        var rpos = match[0].length;\n        this._buffer = this._buffer.slice(rpos);\n        return pkt;\n      } else if (next_char == '(') {\n        pkt.kind = PacketKind.Unknown;\n        this._buffer = this._buffer.slice(3);\n        return pkt;\n      }\n    }\n  }\n\n  ansi_to_html(txt) {\n    this.append_buffer(txt);\n    var blocks = [];\n\n    while (true) {\n      var packet = this.get_next_packet();\n      if (packet.kind == PacketKind.EOS || packet.kind == PacketKind.Incomplete) break;\n      if (packet.kind == PacketKind.ESC || packet.kind == PacketKind.Unknown) continue;\n      if (packet.kind == PacketKind.Text) blocks.push(this.transform_to_html(this.with_state(packet)));else if (packet.kind == PacketKind.SGR) this.process_ansi(packet);else if (packet.kind == PacketKind.OSCURL) blocks.push(this.process_hyperlink(packet));\n    }\n\n    return blocks.join(\"\");\n  }\n\n  with_state(pkt) {\n    return {\n      bold: this.bold,\n      faint: this.faint,\n      italic: this.italic,\n      underline: this.underline,\n      fg: this.fg,\n      bg: this.bg,\n      text: pkt.text\n    };\n  }\n\n  process_ansi(pkt) {\n    let sgr_cmds = pkt.text.split(';');\n\n    while (sgr_cmds.length > 0) {\n      let sgr_cmd_str = sgr_cmds.shift();\n      let num = parseInt(sgr_cmd_str, 10);\n\n      if (isNaN(num) || num === 0) {\n        this.fg = null;\n        this.bg = null;\n        this.bold = false;\n        this.faint = false;\n        this.italic = false;\n        this.underline = false;\n      } else if (num === 1) {\n        this.bold = true;\n      } else if (num === 2) {\n        this.faint = true;\n      } else if (num === 3) {\n        this.italic = true;\n      } else if (num === 4) {\n        this.underline = true;\n      } else if (num === 21) {\n        this.bold = false;\n      } else if (num === 22) {\n        this.faint = false;\n        this.bold = false;\n      } else if (num === 23) {\n        this.italic = false;\n      } else if (num === 24) {\n        this.underline = false;\n      } else if (num === 39) {\n        this.fg = null;\n      } else if (num === 49) {\n        this.bg = null;\n      } else if (num >= 30 && num < 38) {\n        this.fg = this.ansi_colors[0][num - 30];\n      } else if (num >= 40 && num < 48) {\n        this.bg = this.ansi_colors[0][num - 40];\n      } else if (num >= 90 && num < 98) {\n        this.fg = this.ansi_colors[1][num - 90];\n      } else if (num >= 100 && num < 108) {\n        this.bg = this.ansi_colors[1][num - 100];\n      } else if (num === 38 || num === 48) {\n        if (sgr_cmds.length > 0) {\n          let is_foreground = num === 38;\n          let mode_cmd = sgr_cmds.shift();\n\n          if (mode_cmd === '5' && sgr_cmds.length > 0) {\n            let palette_index = parseInt(sgr_cmds.shift(), 10);\n\n            if (palette_index >= 0 && palette_index <= 255) {\n              if (is_foreground) this.fg = this.palette_256[palette_index];else this.bg = this.palette_256[palette_index];\n            }\n          }\n\n          if (mode_cmd === '2' && sgr_cmds.length > 2) {\n            let r = parseInt(sgr_cmds.shift(), 10);\n            let g = parseInt(sgr_cmds.shift(), 10);\n            let b = parseInt(sgr_cmds.shift(), 10);\n\n            if (r >= 0 && r <= 255 && g >= 0 && g <= 255 && b >= 0 && b <= 255) {\n              let c = {\n                rgb: [r, g, b],\n                class_name: 'truecolor'\n              };\n              if (is_foreground) this.fg = c;else this.bg = c;\n            }\n          }\n        }\n      }\n    }\n  }\n\n  transform_to_html(fragment) {\n    let txt = fragment.text;\n    if (txt.length === 0) return txt;\n    txt = this.escape_txt_for_html(txt);\n    if (!fragment.bold && !fragment.italic && !fragment.faint && !fragment.underline && fragment.fg === null && fragment.bg === null) return txt;\n    let styles = [];\n    let classes = [];\n    let fg = fragment.fg;\n    let bg = fragment.bg;\n    if (fragment.bold) styles.push(this._boldStyle);\n    if (fragment.faint) styles.push(this._faintStyle);\n    if (fragment.italic) styles.push(this._italicStyle);\n    if (fragment.underline) styles.push(this._underlineStyle);\n\n    if (!this._use_classes) {\n      if (fg) styles.push(`color:rgb(${fg.rgb.join(',')})`);\n      if (bg) styles.push(`background-color:rgb(${bg.rgb})`);\n    } else {\n      if (fg) {\n        if (fg.class_name !== 'truecolor') {\n          classes.push(`${fg.class_name}-fg`);\n        } else {\n          styles.push(`color:rgb(${fg.rgb.join(',')})`);\n        }\n      }\n\n      if (bg) {\n        if (bg.class_name !== 'truecolor') {\n          classes.push(`${bg.class_name}-bg`);\n        } else {\n          styles.push(`background-color:rgb(${bg.rgb.join(',')})`);\n        }\n      }\n    }\n\n    let class_string = '';\n    let style_string = '';\n    if (classes.length) class_string = ` class=\"${classes.join(' ')}\"`;\n    if (styles.length) style_string = ` style=\"${styles.join(';')}\"`;\n    return `<span${style_string}${class_string}>${txt}</span>`;\n  }\n\n  process_hyperlink(pkt) {\n    let parts = pkt.url.split(':');\n    if (parts.length < 1) return '';\n    if (!this._url_allowlist[parts[0]]) return '';\n    let result = `<a href=\"${this.escape_txt_for_html(pkt.url)}\">${this.escape_txt_for_html(pkt.text)}</a>`;\n    return result;\n  }\n\n}\n\nfunction rgx(tmplObj, ...subst) {\n  let regexText = tmplObj.raw[0];\n  let wsrgx = /^\\s+|\\s+\\n|\\s*#[\\s\\S]*?\\n|\\n/gm;\n  let txt2 = regexText.replace(wsrgx, '');\n  return new RegExp(txt2);\n}\n\nfunction rgxG(tmplObj, ...subst) {\n  let regexText = tmplObj.raw[0];\n  let wsrgx = /^\\s+|\\s+\\n|\\s*#[\\s\\S]*?\\n|\\n/gm;\n  let txt2 = regexText.replace(wsrgx, '');\n  return new RegExp(txt2, 'g');\n}\n\nvar templateObject_1, templateObject_2, templateObject_3;","map":null,"metadata":{},"sourceType":"module"}