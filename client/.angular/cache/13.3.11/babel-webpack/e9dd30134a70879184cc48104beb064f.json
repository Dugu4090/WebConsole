{"ast":null,"code":"import { BehaviorSubject } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nexport let StorageService = /*#__PURE__*/(() => {\n  class StorageService {\n    constructor() {\n      //BehaviorSubjects for latest settings values\n      this.widerViewportSubject = new BehaviorSubject(false);\n      this.initializeLocalStorage();\n    }\n    /**\n     * Initialize settings\n     */\n\n\n    initializeLocalStorage() {\n      //If undefined, initialize localStorage\n      if (typeof window.localStorage[\"WebConsole\"] === 'undefined') {\n        //Create empty object\n        var storageObj = {\n          servers: [],\n          language: \"\",\n          settings: {\n            dateTimePrefix: true,\n            retrieveLogFile: true,\n            blurryUri: false,\n            widerViewport: false\n          }\n        }; //Save to WebStorage\n\n        window.localStorage[\"WebConsole\"] = JSON.stringify(storageObj);\n      } //Initialize BehaviorSubjects\n\n\n      this.widerViewportSubject.next(this.getSetting(SettingsEnum.WiderViewport));\n    }\n    /**\n     * Get a list of all saved servers\n     * @returns List of all servers saved\n     */\n\n\n    getAllServers() {\n      var storageObj = JSON.parse(window.localStorage[\"WebConsole\"]);\n      return storageObj.servers;\n    }\n    /**\n     * Get server info given its name\n     * @param serverName Server name\n     * @returns Server details, null if not found\n     */\n\n\n    getServer(serverName) {\n      return this.getAllServers().find(e => e.serverName == serverName);\n    }\n    /**\n     * Save a new server or, in case a server with same name already exists, update it.\n     * @param serverName Name of the server to add or update\n     * @param serverUri URI of the server\n     */\n\n\n    saveServer(serverName, serverUri, serverPassword) {\n      //Get all saved servers\n      let servers = this.getAllServers();\n      let server = servers.find(e => e.serverName == serverName);\n\n      if (server) {\n        //If server exists, update it\n        server.serverURI = serverUri;\n        if (serverPassword) server.serverPassword = serverPassword;else if (serverPassword == null) server.serverPassword = undefined;\n      } else {\n        //If it does not exist, add to the array\n        const serverToSave = {\n          serverName: serverName,\n          serverURI: serverUri,\n          serverPassword: serverPassword\n        };\n        servers.push(serverToSave);\n      } //Overwrite array\n\n\n      this.replaceAllServers(servers);\n    }\n\n    moveServerToIndex(serverName, newIndex) {\n      //Prevent moving if index is not valid\n      const listOfServers = this.getAllServers();\n\n      if (newIndex < 0 || newIndex >= listOfServers.length) {\n        return;\n      } //Prevent moving if server does not exist\n\n\n      const serverIndex = listOfServers.findIndex(e => e.serverName == serverName);\n      if (serverIndex === -1) return; //Move server\n\n      const serverToMove = listOfServers.find(e => e.serverName == serverName);\n      listOfServers.splice(serverIndex, 1); //Remove element from its current position\n\n      listOfServers.splice(newIndex, 0, serverToMove); //Inject element in new position\n\n      this.replaceAllServers(listOfServers);\n    }\n    /**\n     * Delete a server given its name\n     * @param serverName Name of the server\n     */\n\n\n    deleteServer(serverName) {\n      //Get all servers\n      var servers = this.getAllServers(); //Delete it\n\n      servers = servers.filter(e => e.serverName != serverName); //Save to LocalStorage\n\n      this.replaceAllServers(servers);\n    }\n    /**\n     * Save to persistence a new default language\n     * @param lang Language to set\n     */\n\n\n    setLanguage(lang) {\n      //Retrieve saved data\n      var storageObj = JSON.parse(window.localStorage[\"WebConsole\"]);\n      storageObj.language = lang; //Save to WebStorage\n\n      window.localStorage[\"WebConsole\"] = JSON.stringify(storageObj);\n    }\n    /**\n     * Get saved language\n     * @returns Language saved\n     */\n\n\n    getLanguage() {\n      var storageObj = JSON.parse(window.localStorage[\"WebConsole\"]);\n      if (!storageObj.language) return \"en_US\";\n      return storageObj.language;\n    }\n    /**\n     * Replace ALL servers with the provided server list\n     * @param newServerList New server list\n     */\n\n\n    replaceAllServers(newServerList) {\n      //Retrieve saved data\n      let storageObj = JSON.parse(window.localStorage[\"WebConsole\"]);\n      storageObj.servers = newServerList; //Save to WebStorage\n\n      window.localStorage[\"WebConsole\"] = JSON.stringify(storageObj);\n    }\n    /**\n     * Update setting value\n     * @param setting Setting to set\n     * @param value Value to set\n     */\n\n\n    setSetting(setting, value) {\n      let currentSettings = JSON.parse(window.localStorage[\"WebConsole\"]);\n\n      switch (setting) {\n        case SettingsEnum.DateTimePrefix:\n          currentSettings.settings.dateTimePrefix = value;\n          break;\n\n        case SettingsEnum.RetrieveLogFile:\n          currentSettings.settings.retrieveLogFile = value;\n          break;\n\n        case SettingsEnum.BlurryUri:\n          currentSettings.settings.blurryUri = value;\n          break;\n\n        case SettingsEnum.WiderViewport:\n          currentSettings.settings.widerViewport = value;\n          this.widerViewportSubject.next(value);\n          break;\n      } //Save all\n\n\n      let storageObj = JSON.parse(window.localStorage[\"WebConsole\"]);\n      storageObj.settings = currentSettings.settings;\n      window.localStorage[\"WebConsole\"] = JSON.stringify(storageObj);\n    }\n    /**\n     * Get a setting\n     * @param setting Setting to get\n     * @returns Settings value\n     */\n\n\n    getSetting(setting) {\n      let currentSettings = JSON.parse(window.localStorage[\"WebConsole\"]);\n\n      switch (setting) {\n        case SettingsEnum.DateTimePrefix:\n          return currentSettings.settings.dateTimePrefix;\n\n        case SettingsEnum.RetrieveLogFile:\n          return currentSettings.settings.retrieveLogFile;\n\n        case SettingsEnum.BlurryUri:\n          return currentSettings.settings.blurryUri;\n\n        case SettingsEnum.WiderViewport:\n          return currentSettings.settings.widerViewport;\n      }\n    }\n    /**\n     * Import settings from a Base64-encoded JSON\n     * @param base64settings Encoded settings\n     * @returns True if imported successfully, false otherwise\n     */\n\n\n    importSettings(base64settings) {\n      try {\n        const decodedJsonSettings = atob(base64settings);\n        window.localStorage[\"WebConsole\"] = decodedJsonSettings;\n        return true;\n      } catch (e) {\n        return false;\n      }\n    }\n    /**\n     * Export settings\n     * @returns A Base64-encoded JSON containing settings\n     */\n\n\n    getExportString() {\n      return btoa(window.localStorage[\"WebConsole\"]);\n    }\n\n  }\n\n  StorageService.ɵfac = function StorageService_Factory(t) {\n    return new (t || StorageService)();\n  };\n\n  StorageService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: StorageService,\n    factory: StorageService.ɵfac,\n    providedIn: 'root'\n  });\n  return StorageService;\n})();\nexport var SettingsEnum = /*#__PURE__*/(() => {\n  (function (SettingsEnum) {\n    SettingsEnum[SettingsEnum[\"DateTimePrefix\"] = 0] = \"DateTimePrefix\";\n    SettingsEnum[SettingsEnum[\"RetrieveLogFile\"] = 1] = \"RetrieveLogFile\";\n    SettingsEnum[SettingsEnum[\"BlurryUri\"] = 2] = \"BlurryUri\";\n    SettingsEnum[SettingsEnum[\"WiderViewport\"] = 3] = \"WiderViewport\";\n  })(SettingsEnum || (SettingsEnum = {}));\n\n  return SettingsEnum;\n})();","map":null,"metadata":{},"sourceType":"module"}