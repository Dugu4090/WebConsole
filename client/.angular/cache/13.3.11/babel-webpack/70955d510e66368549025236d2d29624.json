{"ast":null,"code":"import { Icons } from 'src/app/shared/icons';\nimport { WebSocketCommandEnum } from 'src/app/_dto/command/WebSocketCommandEnum';\nimport { ConnectionStatusEnum } from 'src/app/_dto/ConnectionStatusEnum';\nimport { SettingsEnum } from 'src/app/_services/storage.service';\nimport { AnsiUp } from \"ansi_up\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"src/app/_services/storage.service\";\nimport * as i3 from \"src/app/_services/webconsole.service\";\nimport * as i4 from \"@ng-bootstrap/ng-bootstrap\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"@fortawesome/angular-fontawesome\";\nimport * as i7 from \"@angular/forms\";\nimport * as i8 from \"@ngx-translate/core\";\nimport * as i9 from \"../../shared/sanitize.pipe\";\nconst _c0 = [\"consoleDiv\"];\nconst _c1 = [\"setPasswordModal\"];\nconst _c2 = [\"commandInput\"];\n\nfunction ConsoleComponent_button_5_fa_icon_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"fa-icon\", 30);\n  }\n\n  if (rf & 2) {\n    const ctx_r13 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"icon\", ctx_r13.icons.faEye);\n  }\n}\n\nfunction ConsoleComponent_button_5_fa_icon_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"fa-icon\", 30);\n  }\n\n  if (rf & 2) {\n    const ctx_r14 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"icon\", ctx_r14.icons.faEyeSlash);\n  }\n}\n\nfunction ConsoleComponent_button_5_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r16 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"button\", 28);\n    i0.ɵɵlistener(\"click\", function ConsoleComponent_button_5_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r16);\n      const ctx_r15 = i0.ɵɵnextContext();\n      return ctx_r15.showServerInfo = !ctx_r15.showServerInfo;\n    });\n    i0.ɵɵtemplate(1, ConsoleComponent_button_5_fa_icon_1_Template, 1, 1, \"fa-icon\", 29);\n    i0.ɵɵtemplate(2, ConsoleComponent_button_5_fa_icon_2_Template, 1, 1, \"fa-icon\", 29);\n    i0.ɵɵtext(3);\n    i0.ɵɵpipe(4, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r0.showServerInfo);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.showServerInfo);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(4, 3, \"CONSOLE.ToggleServerInfo\"), \" \");\n  }\n}\n\nfunction ConsoleComponent_span_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 31);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(2, 1, \"CONSOLE.Connected\"));\n  }\n}\n\nfunction ConsoleComponent_span_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 32);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(2, 1, \"CONSOLE.Disconnected\"));\n  }\n}\n\nfunction ConsoleComponent_span_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 33);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate3(\"\", i0.ɵɵpipeBind1(2, 3, \"CONSOLE.LoggedInAs\"), \" \", ctx_r3.loggedInUsername, \" (\", ctx_r3.loggedInAs, \")\");\n  }\n}\n\nfunction ConsoleComponent_div_53_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r18 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 34)(2, \"button\", 35);\n    i0.ɵɵlistener(\"click\", function ConsoleComponent_div_53_Template_button_click_2_listener() {\n      i0.ɵɵrestoreView(_r18);\n      const ctx_r17 = i0.ɵɵnextContext();\n      return ctx_r17.requestPassword();\n    });\n    i0.ɵɵelement(3, \"fa-icon\", 30);\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"translate\");\n    i0.ɵɵelementEnd()()();\n  }\n\n  if (rf & 2) {\n    const ctx_r6 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"icon\", ctx_r6.icons.faLock);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(5, 2, \"CONSOLE.ClickToLogin\"), \" \");\n  }\n}\n\nfunction ConsoleComponent_div_64_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 36)(1, \"div\", 37)(2, \"span\", 38);\n    i0.ɵɵtext(3);\n    i0.ɵɵpipe(4, \"translate\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"p\");\n    i0.ɵɵtext(6);\n    i0.ɵɵpipe(7, \"translate\");\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(4, 2, \"GENERAL.Loading\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(7, 4, \"CONSOLE.Connecting\"));\n  }\n}\n\nfunction ConsoleComponent_div_65_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 36);\n    i0.ɵɵelement(1, \"fa-icon\", 39);\n    i0.ɵɵelementStart(2, \"p\", 40);\n    i0.ɵɵtext(3);\n    i0.ɵɵpipe(4, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"p\", 40);\n    i0.ɵɵtext(6);\n    i0.ɵɵpipe(7, \"translate\");\n    i0.ɵɵelementStart(8, \"a\", 41);\n    i0.ɵɵtext(9);\n    i0.ɵɵpipe(10, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(11);\n    i0.ɵɵpipe(12, \"translate\");\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r10 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"icon\", ctx_r10.icons.faXmark);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(4, 5, \"CONSOLE.CannotConnect\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\"\", i0.ɵɵpipeBind1(7, 7, \"CONSOLE.CannotConnectDescription1\"), \" \");\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(10, 9, \"CONSOLE.Tool\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(12, 11, \"CONSOLE.CannotConnectDescription2\"), \" \");\n  }\n}\n\nfunction ConsoleComponent_ng_template_66_small_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\", 56);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(2, 1, \"CONSOLE.WrongPassword\"));\n  }\n}\n\nfunction ConsoleComponent_ng_template_66_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r24 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 42)(1, \"h4\", 43);\n    i0.ɵɵtext(2);\n    i0.ɵɵpipe(3, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"button\", 44);\n    i0.ɵɵlistener(\"click\", function ConsoleComponent_ng_template_66_Template_button_click_4_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r24);\n      const modal_r19 = restoredCtx.$implicit;\n      return modal_r19.dismiss(\"Cross click\");\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"div\", 45)(6, \"form\", 46)(7, \"div\", 34)(8, \"input\", 47, 48);\n    i0.ɵɵlistener(\"keyup.enter\", function ConsoleComponent_ng_template_66_Template_input_keyup_enter_8_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r24);\n      const modal_r19 = restoredCtx.$implicit;\n\n      const _r20 = i0.ɵɵreference(9);\n\n      const _r22 = i0.ɵɵreference(14);\n\n      const ctx_r25 = i0.ɵɵnextContext();\n      ctx_r25.setPassword(_r20.value, _r22.checked);\n      return modal_r19.close();\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(10, ConsoleComponent_ng_template_66_small_10_Template, 3, 3, \"small\", 49);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"div\", 34)(12, \"div\", 50);\n    i0.ɵɵelement(13, \"input\", 51, 52);\n    i0.ɵɵelementStart(15, \"label\", 53);\n    i0.ɵɵtext(16);\n    i0.ɵɵpipe(17, \"translate\");\n    i0.ɵɵelementEnd()()()()();\n    i0.ɵɵelementStart(18, \"div\", 54)(19, \"button\", 55);\n    i0.ɵɵlistener(\"click\", function ConsoleComponent_ng_template_66_Template_button_click_19_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r24);\n      const modal_r19 = restoredCtx.$implicit;\n\n      const _r20 = i0.ɵɵreference(9);\n\n      const _r22 = i0.ɵɵreference(14);\n\n      const ctx_r26 = i0.ɵɵnextContext();\n      ctx_r26.setPassword(_r20.value, _r22.checked);\n      return modal_r19.close();\n    });\n    i0.ɵɵtext(20);\n    i0.ɵɵpipe(21, \"translate\");\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r12 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(3, 4, \"CONSOLE.PasswordRequested\"));\n    i0.ɵɵadvance(8);\n    i0.ɵɵproperty(\"ngIf\", ctx_r12.savedPasswordSent);\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(17, 6, \"CONSOLE.RememberPassword\"), \" \");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(21, 8, \"CONSOLE.Connect\"));\n  }\n}\n\nexport let ConsoleComponent = /*#__PURE__*/(() => {\n  class ConsoleComponent {\n    constructor(route, router, storageService, webConsoleService, modalService) {\n      this.route = route;\n      this.router = router;\n      this.storageService = storageService;\n      this.webConsoleService = webConsoleService;\n      this.modalService = modalService; //General stuff\n\n      this.icons = Icons;\n      this.consoleHtml = \"\"; //Server Insights\n\n      this.connectedPlayers = 0;\n      this.maxPlayers = 0;\n      this.cpuUsage = 0;\n      this.ramFree = 0;\n      this.ramUsed = 0;\n      this.ramMax = 0;\n      this.tps = 0; //Helper properties\n\n      this.keepScrollDown = true;\n      this.showServerInfo = true;\n      this.showConsole = false;\n      this.loggedInUsername = \"\";\n      this.loggedInAs = \"\";\n      this.savedPasswordSent = false;\n      this.browsingCommandHistoryIndex = -1;\n    }\n    /**\n     * On component initialization, connect to WebSocket server and subscribe to subjects (where WebSocket messages are received)\n     */\n\n\n    ngOnInit() {\n      console.log(\"Init console component\"); //Get server name from params\n\n      const routeParams = this.route.snapshot.paramMap;\n      const serverName = routeParams.get('serverName'); //If server name not provided, throw error and redirect to homepage\n\n      if (!serverName) {\n        this.router.navigate(['']);\n        throw Error(\"Server name not provided\");\n      } //Get server from its name. If not found, redirect to homepage\n\n\n      const serverObject = this.storageService.getServer(serverName);\n\n      if (!serverObject) {\n        this.router.navigate(['']);\n        throw Error(\"Server name invalid\");\n      } //Save server object and connect\n\n\n      this.server = serverObject; //Connect to server\n\n      this.activeConnection = this.webConsoleService.connect(this.server.serverName);\n      this.showConsole = this.activeConnection.connectionStatus == ConnectionStatusEnum.Connected; //Process old messages (In case we are resuming a session)\n\n      this.activeConnection.receivedMessages.forEach(e => this.processMessage(e)); //If not created, create the Players, CPU, RAM and TPS interval\n\n      if (!this.insightsInverval) {\n        this.insightsInverval = setInterval(() => {\n          this.requestServerInsights();\n        }, 2500);\n      } //Subscribe to Subject to process received messages\n\n\n      this.subscription = this.activeConnection.subject$.subscribe({\n        next: msg => {\n          this.showConsole = true;\n          this.processMessage(msg);\n        },\n        complete: () => {\n          //Disconnected from server\n          this.showServerInfo = false;\n        }\n      });\n    }\n\n    ngAfterViewInit() {\n      //Scroll down console\n      setTimeout(() => {\n        var _a;\n\n        return this.consoleDiv.nativeElement.scrollTop = (_a = this.consoleDiv) === null || _a === void 0 ? void 0 : _a.nativeElement.scrollHeight;\n      });\n    }\n    /**\n     * On component destruction, unsubscribe to subject\n     */\n\n\n    ngOnDestroy() {\n      //Stop insights\n      clearInterval(this.insightsInverval); //Remove subscription as this component is going mayday\n\n      this.subscription.unsubscribe();\n    }\n    /**\n     * Process a new message from WebSockets\n     * @param response WebSocket message\n     */\n\n\n    processMessage(response) {\n      // console.log(`Received message from WebSocket (${this.server.serverName}): `, msg);\n      let r;\n\n      switch (response.status) {\n        case 10:\n          //Console output\n          r = response;\n          this.writeToWebConsole(r.message, r.time);\n          break;\n\n        case 200:\n          //LoggedIn\n          r = response;\n          this.loggedInUsername = r.username;\n          this.loggedInAs = r.as;\n          break;\n\n        case 400:\n          //Unknown\n          r = response;\n          console.log(\"400 Unknown Comamnd\", r);\n          break;\n\n        case 401:\n          //Login Required\n          r = response;\n\n          if (!this.activeConnection.isLoggedIn) {\n            if (this.server.serverPassword && !this.savedPasswordSent) {\n              this.savedPasswordSent = true;\n              this.webConsoleService.sendMessage(this.server.serverName, WebSocketCommandEnum.Login, this.server.serverPassword);\n            } else {\n              this.requestPassword();\n            }\n          }\n\n          break;\n\n        case 1000:\n          //Players\n          r = response;\n          this.connectedPlayers = r.connectedPlayers;\n          this.maxPlayers = r.maxPlayers;\n          break;\n\n        case 1001:\n          //CPU Usage\n          r = response;\n          this.cpuUsage = r.usage;\n          break;\n\n        case 1002:\n          //RAM usage\n          r = response;\n          this.ramFree = r.free;\n          this.ramUsed = r.used;\n          this.ramMax = r.max;\n          break;\n\n        case 1003:\n          //TPS\n          r = response;\n          this.tps = r.tps;\n          break;\n\n        default:\n          //Not recognised response\n          console.error(\"Unrecognised response:\", response);\n          break;\n      }\n    }\n    /**\n     * Sanitize and print message to console\n     * @param msg Message to print\n     * @param time Time, if applicable\n     */\n\n\n    writeToWebConsole(msg, time) {\n      var _a, _b, _c;\n\n      this.keepScrollDown = ((_a = this.consoleDiv) === null || _a === void 0 ? void 0 : _a.nativeElement.scrollHeight) - ((_b = this.consoleDiv) === null || _b === void 0 ? void 0 : _b.nativeElement.scrollTop) === ((_c = this.consoleDiv) === null || _c === void 0 ? void 0 : _c.nativeElement.clientHeight); //Write to div, replacing < to &lt; (to avoid XSS) and replacing new line to br.\n\n      msg = msg.replace(/</g, \"&lt;\");\n      msg = msg.replace(/(?:\\r\\n|\\r|\\n)/g, \"<br>\"); //Color filter for MC codes.\n\n      msg = msg.replace(/§0/g, \"<span style='color: #000000;'>\"); //&0\n\n      msg = msg.replace(/§1/g, \"<span style='color: #0000AA;'>\"); //&1\n\n      msg = msg.replace(/§2/g, \"<span style='color: #00AA00;'>\"); //&2\n\n      msg = msg.replace(/§3/g, \"<span style='color: #00AAAA;'>\"); //&3\n\n      msg = msg.replace(/§4/g, \"<span style='color: #AA0000;'>\"); //&4\n\n      msg = msg.replace(/§5/g, \"<span style='color: #AA00AA;'>\"); //&5\n\n      msg = msg.replace(/§6/g, \"<span style='color: #FFAA00;'>\"); //&6\n\n      msg = msg.replace(/§7/g, \"<span style='color: #AAAAAA;'>\"); //&7\n\n      msg = msg.replace(/§8/g, \"<span style='color: #555555;'>\"); //&8\n\n      msg = msg.replace(/§9/g, \"<span style='color: #5555FF;'>\"); //&9\n\n      msg = msg.replace(/§a/g, \"<span style='color: #55FF55;'>\"); //&a\n\n      msg = msg.replace(/§b/g, \"<span style='color: #55FFFF;'>\"); //&b\n\n      msg = msg.replace(/§c/g, \"<span style='color: #FF5555;'>\"); //&c\n\n      msg = msg.replace(/§d/g, \"<span style='color: #FF55FF;'>\"); //&d\n\n      msg = msg.replace(/§e/g, \"<span style='color: #FFFF55;'>\"); //&e\n\n      msg = msg.replace(/§f/g, \"<span style='color: #FFFFFF;'>\"); //&f\n\n      msg = msg.replace(/§l/g, \"<span style='font-weight:bold;'>\"); //&l\n\n      msg = msg.replace(/§m/g, \"<span style='text-decoration: line-through;'>\"); //&m\n\n      msg = msg.replace(/§n/g, \"<span style='text-decoration: underline;'>\"); //&n\n\n      msg = msg.replace(/§o/g, \"<span style='font-style: italic;'>\"); //&o\n\n      msg = msg.replace(/§r/g, \"</span>\"); //&r\n      //Color filter for MC 1.18 (Also easy :D)\n\n      msg = msg.replace(/0/g, \"<span style='color: #000000;'>\"); //&0\n\n      msg = msg.replace(/1/g, \"<span style='color: #0000AA;'>\"); //&1\n\n      msg = msg.replace(/2/g, \"<span style='color: #00AA00;'>\"); //&2\n\n      msg = msg.replace(/3/g, \"<span style='color: #00AAAA;'>\"); //&3\n\n      msg = msg.replace(/4/g, \"<span style='color: #AA0000;'>\"); //&4\n\n      msg = msg.replace(/5/g, \"<span style='color: #AA00AA;'>\"); //&5\n\n      msg = msg.replace(/6/g, \"<span style='color: #FFAA00;'>\"); //&6\n\n      msg = msg.replace(/7/g, \"<span style='color: #AAAAAA;'>\"); //&7\n\n      msg = msg.replace(/8/g, \"<span style='color: #555555;'>\"); //&8\n\n      msg = msg.replace(/9/g, \"<span style='color: #5555FF;'>\"); //&9\n\n      msg = msg.replace(/a/g, \"<span style='color: #55FF55;'>\"); //&a\n\n      msg = msg.replace(/b/g, \"<span style='color: #55FFFF;'>\"); //&b\n\n      msg = msg.replace(/c/g, \"<span style='color: #FF5555;'>\"); //&c\n\n      msg = msg.replace(/d/g, \"<span style='color: #FF55FF;'>\"); //&d\n\n      msg = msg.replace(/e/g, \"<span style='color: #FFFF55;'>\"); //&e\n\n      msg = msg.replace(/f/g, \"<span style='color: #FFFFFF;'>\"); //&f\n\n      msg = msg.replace(/l/g, \"<span style='font-weight:bold;'>\"); //&l\n\n      msg = msg.replace(/m/g, \"<span style='text-decoration: line-through;'>\"); //&m\n\n      msg = msg.replace(/n/g, \"<span style='text-decoration: underline;'>\"); //&n\n\n      msg = msg.replace(/o/g, \"<span style='font-style: italic;'>\"); //&o\n\n      msg = msg.replace(/r/g, \"</span>\"); //&r\n      // ANSI Processing\n\n      var ansi_up = new AnsiUp();\n      msg = ansi_up.ansi_to_html(msg); //Append datetime if enabled\n\n      if (this.storageService.getSetting(SettingsEnum.DateTimePrefix)) {\n        if (typeof time !== 'undefined' && time !== null) //if time is present and not null\n          msg = \"[\" + time + \"] \" + msg;else if (typeof time !== 'undefined' && time === null) //if time is present and null\n          null; //no time (is already printed)\n        else msg = \"[\" + new Date().toLocaleTimeString() + \"] \" + msg;\n      } //Append HTML\n\n\n      const spanCount = (msg.match(/<span /g) || []).length; //Number of times a color is applied\n\n      const spanCloseCount = (msg.match(/<\\/span> /g) || []).length; //Number of already existing </span>\n\n      const numberOfUnclosedSpans = spanCount - spanCloseCount; //Number of </span> pending to be closed\n\n      this.consoleHtml += msg + \"</span>\".repeat(numberOfUnclosedSpans) + \"<br>\"; //Append to console the message, plus the required </span>'s, plus a line break\n    }\n    /**\n     * Open password request modal\n     */\n\n\n    requestPassword() {\n      this.modalService.open(this.passwordModal, {\n        size: 'md'\n      });\n    }\n    /**\n     * Try to login against server\n     * @param password Password to send\n     * @param rememberPassword If true, save password in localStorage\n     */\n\n\n    setPassword(password, rememberPassword) {\n      //Edit server if remember password checkbox is checked\n      if (rememberPassword) this.storageService.saveServer(this.server.serverName, this.server.serverURI, password);\n      setTimeout(() => this.savedPasswordSent = true, 200); //Send login message\n\n      this.webConsoleService.sendMessage(this.server.serverName, WebSocketCommandEnum.Login, password);\n    }\n    /**\n     * Send command typed in the command input\n     */\n\n\n    sendCommand() {\n      const cmd = this.commandInput.nativeElement.value;\n      if (!cmd) return; //Clear input\n\n      this.commandInput.nativeElement.value = \"\";\n      this.browsingCommandHistoryIndex = -1;\n      this.webConsoleService.sendMessage(this.server.serverName, WebSocketCommandEnum.Exec, cmd);\n    }\n    /**\n     * Called when a key is pressed in the command input\n     * @param e KeyboardEvent\n     */\n\n\n    onKeyUpCommandInput(e) {\n      var _a, _b;\n\n      if (e.code === 'Enter') {\n        //Detect enter key\n        this.sendCommand();\n      } else if (e.code === \"ArrowUp\") {\n        //Replace with older command\n        //Get list of sent commands\n        const sentCommands = this.activeConnection.sentCommands.filter(e => e.command === WebSocketCommandEnum.Exec); //If no command was sent yet, return\n\n        if (sentCommands.length == 0) return; //If this is the first time arrow up is pressed, start browsing history\n\n        if (this.browsingCommandHistoryIndex <= 0) this.browsingCommandHistoryIndex = sentCommands.length; //Set command in our input component\n\n        this.commandInput.nativeElement.value = (_a = sentCommands[this.browsingCommandHistoryIndex - 1]) === null || _a === void 0 ? void 0 : _a.params;\n        this.browsingCommandHistoryIndex = this.browsingCommandHistoryIndex - 1;\n      } else if (e.code === \"ArrowDown\") {\n        //Replace with newer command\n        //Get list of sent commands\n        const sentCommands = this.activeConnection.sentCommands.filter(e => e.command === WebSocketCommandEnum.Exec); //If not browsing history, do nothing\n\n        if (this.browsingCommandHistoryIndex !== -1) {\n          //Go back to index 0 if overflow\n          if (this.browsingCommandHistoryIndex >= sentCommands.length - 1) this.browsingCommandHistoryIndex = -1; //Set command in our input component\n\n          this.commandInput.nativeElement.value = (_b = sentCommands[this.browsingCommandHistoryIndex + 1]) === null || _b === void 0 ? void 0 : _b.params;\n          this.browsingCommandHistoryIndex = this.browsingCommandHistoryIndex + 1;\n        }\n      } else if (e.code == \"tab\") {//Detect tab key\n        //Suggest user from connected Players\n        //TODO tab not being detected :(\n      }\n    }\n    /**\n     * Request server insights\n     */\n\n\n    requestServerInsights() {\n      if (this.showServerInfo && this.showConsole && this.activeConnection.connectionStatus == ConnectionStatusEnum.Connected && this.activeConnection.isLoggedIn) {\n        this.webConsoleService.sendMessage(this.server.serverName, WebSocketCommandEnum.Players);\n        this.webConsoleService.sendMessage(this.server.serverName, WebSocketCommandEnum.CpuUsage);\n        this.webConsoleService.sendMessage(this.server.serverName, WebSocketCommandEnum.RamUsage);\n        this.webConsoleService.sendMessage(this.server.serverName, WebSocketCommandEnum.Tps);\n      }\n    }\n\n  }\n\n  ConsoleComponent.ɵfac = function ConsoleComponent_Factory(t) {\n    return new (t || ConsoleComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.StorageService), i0.ɵɵdirectiveInject(i3.WebconsoleService), i0.ɵɵdirectiveInject(i4.NgbModal));\n  };\n\n  ConsoleComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ConsoleComponent,\n    selectors: [[\"app-console\"]],\n    viewQuery: function ConsoleComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 5);\n        i0.ɵɵviewQuery(_c1, 5);\n        i0.ɵɵviewQuery(_c2, 5);\n      }\n\n      if (rf & 2) {\n        let _t;\n\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.consoleDiv = _t.first);\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.passwordModal = _t.first);\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.commandInput = _t.first);\n      }\n    },\n    decls: 68,\n    vars: 52,\n    consts: [[1, \"row\"], [1, \"col\"], [1, \"col-md-auto\", \"d-flex\", \"align-self-center\"], [\"type\", \"button\", \"class\", \"btn btn-outline-primary\", 3, \"click\", 4, \"ngIf\"], [\"class\", \"badge bg-success me-1\", 4, \"ngIf\"], [\"class\", \"badge bg-danger mb-3\", 4, \"ngIf\"], [\"class\", \"badge bg-secondary mb-3\", 4, \"ngIf\"], [3, \"ngbCollapse\", \"ngbCollapseChange\"], [\"collapseGlobal\", \"ngbCollapse\"], [1, \"row\", 3, \"ngbCollapse\", \"ngbCollapseChange\"], [\"collapse\", \"ngbCollapse\"], [1, \"col-lg-3\"], [1, \"card\", \"mb-3\"], [1, \"card-body\"], [1, \"card-title\"], [1, \"card-text\"], [\"type\", \"secondary\", 3, \"value\", \"striped\", \"animated\"], [3, \"type\", \"value\", \"striped\", \"animated\"], [\"class\", \"row\", 4, \"ngIf\"], [1, \"card\", \"mt-3\", \"mb-3\"], [1, \"card-body\", \"overflow-auto\", \"text-light\", \"bg-dark\", \"console\", 3, \"innerHTML\", \"scrollTop\"], [\"consoleDiv\", \"\"], [1, \"input-group\", \"mb-3\"], [\"type\", \"text\", \"aria-label\", \"Command\", \"aria-describedby\", \"button-command\", 1, \"form-control\", 3, \"disabled\", \"keyup\"], [\"commandInput\", \"\"], [\"type\", \"button\", \"id\", \"button-command\", 1, \"btn\", \"btn-secondary\", 3, \"disabled\", \"click\"], [\"class\", \"d-flex flex-column min-vh-100 align-items-center\", 4, \"ngIf\"], [\"setPasswordModal\", \"\"], [\"type\", \"button\", 1, \"btn\", \"btn-outline-primary\", 3, \"click\"], [3, \"icon\", 4, \"ngIf\"], [3, \"icon\"], [1, \"badge\", \"bg-success\", \"me-1\"], [1, \"badge\", \"bg-danger\", \"mb-3\"], [1, \"badge\", \"bg-secondary\", \"mb-3\"], [1, \"col-12\"], [\"type\", \"button\", 1, \"btn\", \"btn-warning\", \"w-100\", 3, \"click\"], [1, \"d-flex\", \"flex-column\", \"min-vh-100\", \"align-items-center\"], [\"role\", \"status\", 1, \"spinner-border\"], [1, \"visually-hidden\"], [\"size\", \"3x\", 3, \"icon\"], [1, \"mb-0\"], [\"href\", \"https://www.yougetsignal.com/tools/open-ports/\", \"target\", \"_blank\"], [1, \"modal-header\"], [\"id\", \"modal-basic-title\", 1, \"modal-title\"], [\"type\", \"button\", \"aria-label\", \"Close\", 1, \"btn-close\", 3, \"click\"], [1, \"modal-body\"], [1, \"row\", \"g-3\"], [\"type\", \"password\", 1, \"form-control\", 3, \"keyup.enter\"], [\"passwordInput\", \"\"], [\"class\", \"form-text text-danger\", 4, \"ngIf\"], [1, \"form-check\"], [\"type\", \"checkbox\", \"id\", \"rememberCheck\", 1, \"form-check-input\"], [\"rememberInput\", \"\"], [\"for\", \"rememberCheck\", 1, \"form-check-label\"], [1, \"modal-footer\"], [\"type\", \"button\", 1, \"btn\", \"btn-primary\", 3, \"click\"], [1, \"form-text\", \"text-danger\"]],\n    template: function ConsoleComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"h1\");\n        i0.ɵɵtext(3);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(4, \"div\", 2);\n        i0.ɵɵtemplate(5, ConsoleComponent_button_5_Template, 5, 5, \"button\", 3);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵtemplate(6, ConsoleComponent_span_6_Template, 3, 3, \"span\", 4);\n        i0.ɵɵtemplate(7, ConsoleComponent_span_7_Template, 3, 3, \"span\", 5);\n        i0.ɵɵtemplate(8, ConsoleComponent_span_8_Template, 3, 5, \"span\", 6);\n        i0.ɵɵelementStart(9, \"div\", 7, 8);\n        i0.ɵɵlistener(\"ngbCollapseChange\", function ConsoleComponent_Template_div_ngbCollapseChange_9_listener($event) {\n          return !(ctx.showConsole = $event);\n        });\n        i0.ɵɵelementStart(11, \"div\", 9, 10);\n        i0.ɵɵlistener(\"ngbCollapseChange\", function ConsoleComponent_Template_div_ngbCollapseChange_11_listener($event) {\n          return !(ctx.showServerInfo = $event);\n        });\n        i0.ɵɵelementStart(13, \"div\", 11)(14, \"div\", 12)(15, \"div\", 13)(16, \"h5\", 14);\n        i0.ɵɵtext(17);\n        i0.ɵɵpipe(18, \"translate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(19, \"p\", 15);\n        i0.ɵɵtext(20);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(21, \"p\", 15);\n        i0.ɵɵelement(22, \"ngb-progressbar\", 16);\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(23, \"div\", 11)(24, \"div\", 12)(25, \"div\", 13)(26, \"h5\", 14);\n        i0.ɵɵtext(27);\n        i0.ɵɵpipe(28, \"translate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(29, \"p\", 15);\n        i0.ɵɵtext(30);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(31, \"p\", 15);\n        i0.ɵɵelement(32, \"ngb-progressbar\", 17);\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(33, \"div\", 11)(34, \"div\", 12)(35, \"div\", 13)(36, \"h5\", 14);\n        i0.ɵɵtext(37);\n        i0.ɵɵpipe(38, \"translate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(39, \"p\", 15);\n        i0.ɵɵtext(40);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(41, \"p\", 15);\n        i0.ɵɵelement(42, \"ngb-progressbar\", 17);\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(43, \"div\", 11)(44, \"div\", 12)(45, \"div\", 13)(46, \"h5\", 14);\n        i0.ɵɵtext(47);\n        i0.ɵɵpipe(48, \"translate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(49, \"p\", 15);\n        i0.ɵɵtext(50);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(51, \"p\", 15);\n        i0.ɵɵelement(52, \"ngb-progressbar\", 17);\n        i0.ɵɵelementEnd()()()()();\n        i0.ɵɵtemplate(53, ConsoleComponent_div_53_Template, 6, 4, \"div\", 18);\n        i0.ɵɵelementStart(54, \"div\", 19);\n        i0.ɵɵelement(55, \"div\", 20, 21);\n        i0.ɵɵpipe(57, \"sanitize\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(58, \"div\", 22)(59, \"input\", 23, 24);\n        i0.ɵɵlistener(\"keyup\", function ConsoleComponent_Template_input_keyup_59_listener($event) {\n          return ctx.onKeyUpCommandInput($event);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(61, \"button\", 25);\n        i0.ɵɵlistener(\"click\", function ConsoleComponent_Template_button_click_61_listener() {\n          return ctx.sendCommand();\n        });\n        i0.ɵɵtext(62);\n        i0.ɵɵpipe(63, \"translate\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵtemplate(64, ConsoleComponent_div_64_Template, 8, 6, \"div\", 26);\n        i0.ɵɵtemplate(65, ConsoleComponent_div_65_Template, 13, 13, \"div\", 26);\n        i0.ɵɵtemplate(66, ConsoleComponent_ng_template_66_Template, 22, 10, \"ng-template\", null, 27, i0.ɵɵtemplateRefExtractor);\n      }\n\n      if (rf & 2) {\n        const _r7 = i0.ɵɵreference(56);\n\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate(ctx.server.serverName);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.showConsole);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.activeConnection.connectionStatus == 2);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.activeConnection.connectionStatus == 3 && ctx.showConsole);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.activeConnection.connectionStatus == 2 && ctx.loggedInUsername);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngbCollapse\", !ctx.showConsole);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngbCollapse\", !ctx.showServerInfo);\n        i0.ɵɵadvance(6);\n        i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(18, 40, \"CONSOLE.PlayersOnline\"));\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate2(\"\", ctx.connectedPlayers, \" / \", ctx.maxPlayers, \"\");\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"value\", ctx.connectedPlayers * 100 / ctx.maxPlayers)(\"striped\", true)(\"animated\", true);\n        i0.ɵɵadvance(5);\n        i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(28, 42, \"CONSOLE.CpuUsage\"));\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate1(\"\", ctx.cpuUsage, \"%\");\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"type\", ctx.cpuUsage > 80 ? \"danger\" : \"secondary\")(\"value\", ctx.cpuUsage)(\"striped\", true)(\"animated\", true);\n        i0.ɵɵadvance(5);\n        i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(38, 44, \"CONSOLE.RamUsage\"));\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate2(\"\", ctx.ramUsed, \" MB / \", ctx.ramMax, \" MB\");\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"type\", ctx.ramUsed * 100 / ctx.ramMax > 80 ? \"danger\" : \"secondary\")(\"value\", ctx.ramUsed * 100 / ctx.ramMax)(\"striped\", true)(\"animated\", true);\n        i0.ɵɵadvance(5);\n        i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(48, 46, \"CONSOLE.Tps\"));\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate1(\"\", ctx.tps, \" / 20\");\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"type\", ctx.tps * 100 / 20 > 80 ? \"success\" : \"secondary\")(\"value\", ctx.tps * 100 / 20)(\"striped\", true)(\"animated\", true);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !ctx.activeConnection.isLoggedIn);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"innerHTML\", i0.ɵɵpipeBind1(57, 48, ctx.consoleHtml), i0.ɵɵsanitizeHtml)(\"scrollTop\", ctx.keepScrollDown ? _r7.scrollHeight : _r7.scrollTop);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"disabled\", ctx.activeConnection.connectionStatus != 2);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"disabled\", ctx.activeConnection.connectionStatus != 2);\n        i0.ɵɵadvance(1);\n        i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(63, 50, \"CONSOLE.Send\"));\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.activeConnection.connectionStatus == 1);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.activeConnection.connectionStatus == 3 && !ctx.showConsole);\n      }\n    },\n    directives: [i5.NgIf, i6.FaIconComponent, i4.NgbCollapse, i4.NgbProgressbar, i7.ɵNgNoValidate, i7.NgControlStatusGroup, i7.NgForm],\n    pipes: [i8.TranslatePipe, i9.SanitizePipe],\n    styles: [\".console[_ngcontent-%COMP%]{height:480px}\"]\n  });\n  return ConsoleComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}